from .scenario import create_scenario, Scenario
from .run_specs import get_scenario_spec_tiny, get_numeracy_scenario_spec


class TestScenario:
    def setup_method(self, method):
        self.scenario: Scenario = create_scenario(get_scenario_spec_tiny())

    def test_render_lines(self):
        instances = self.scenario.get_instances()
        assert self.scenario.render_lines(instances) == [
            "name: simple1",
            "description: A simple scenario",
            "tags: [simple]",
            "",
            "instance 0 (4 total) |train| {",
            '  input: "4 18 2 8 3"',
            '  reference [correct]: "8"',
            '  reference []: "-1"',
            "}",
            "instance 1 (4 total) |train| {",
            '  input: "14 15 12 6 3"',
            '  reference [correct]: "6"',
            '  reference []: "-1"',
            "}",
            "instance 2 (4 total) |test| {",
            '  input: "0 12 13 19 0"',
            '  reference [correct]: "19"',
            '  reference []: "-1"',
            "}",
            "instance 3 (4 total) |test| {",
            '  input: "8 7 18 3 10"',
            '  reference [correct]: "8"',
            '  reference []: "-1"',
            "}",
        ]


class TestNumeracyScenario:
    def setup_method(self, method):
        self.scenario: Scenario = create_scenario(
            get_numeracy_scenario_spec(seed=1, num_train_instances=20, num_test_instances=1)
        )

    def test_render_lines(self):
        instances = self.scenario.get_instances()
        # print("\n".join(self.scenario.render_lines(instances)))
        print(self.scenario.render_lines(instances))
        assert self.scenario.render_lines(instances) == [
            "Name: numeracy",
            "Description: polynomial equation induction",
            "Tags: []",
            "21 instances",
            "",
            "------- Instance 1/21: [train]",
            "Input: 95",
            "Reference ([correct]): 194",
            "",
            "------- Instance 2/21: [train]",
            "Input: -84",
            "Reference ([correct]): -164",
            "",
            "------- Instance 3/21: [train]",
            "Input: -35",
            "Reference ([correct]): -66",
            "",
            "------- Instance 4/21: [train]",
            "Input: -70",
            "Reference ([correct]): -136",
            "",
            "------- Instance 5/21: [train]",
            "Input: 26",
            "Reference ([correct]): 56",
            "",
            "------- Instance 6/21: [train]",
            "Input: 94",
            "Reference ([correct]): 192",
            "",
            "------- Instance 7/21: [train]",
            "Input: 15",
            "Reference ([correct]): 34",
            "",
            "------- Instance 8/21: [train]",
            "Input: 20",
            "Reference ([correct]): 44",
            "",
            "------- Instance 9/21: [train]",
            "Input: 66",
            "Reference ([correct]): 136",
            "",
            "------- Instance 10/21: [train]",
            "Input: -3",
            "Reference ([correct]): -2",
            "",
            "------- Instance 11/21: [train]",
            "Input: -47",
            "Reference ([correct]): -90",
            "",
            "------- Instance 12/21: [train]",
            "Input: -76",
            "Reference ([correct]): -148",
            "",
            "------- Instance 13/21: [train]",
            "Input: 24",
            "Reference ([correct]): 52",
            "",
            "------- Instance 14/21: [train]",
            "Input: -93",
            "Reference ([correct]): -182",
            "",
            "------- Instance 15/21: [train]",
            "Input: -1",
            "Reference ([correct]): 2",
            "",
            "------- Instance 16/21: [train]",
            "Input: 10",
            "Reference ([correct]): 24",
            "",
            "------- Instance 17/21: [train]",
            "Input: 55",
            "Reference ([correct]): 114",
            "",
            "------- Instance 18/21: [train]",
            "Input: 95",
            "Reference ([correct]): 194",
            "",
            "------- Instance 19/21: [train]",
            "Input: 96",
            "Reference ([correct]): 196",
            "",
            "------- Instance 20/21: [train]",
            "Input: -100",
            "Reference ([correct]): -196",
            "",
            "------- Instance 21/21: [test]",
            "Input: 78",
            "Reference ([correct]): 160",
            "",
        ]
